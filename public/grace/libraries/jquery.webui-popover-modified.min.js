(function(g,z,r,A){function p(a,b){this.$element=g(a);if(b&&("string"===g.type(b.delay)||"number"===g.type(b.delay)))b.delay={show:b.delay,hide:b.delay};this.options=g.extend({},v,b);this._defaults=v;this._name=q;this._targetclick=!1;this.init();m.push(this.$element)}var q="webuiPopover",v={placement:"auto",width:"auto",height:"auto",trigger:"click",style:"",delay:{show:null,hide:null},async:{before:null,success:null},cache:!0,multi:!1,arrow:!0,title:"",content:"",closeable:!1,padding:!0,url:"",type:"html",
animation:null,template:'<div class="webui-popover"><div class="arrow"></div><div class="webui-popover-inner"><a href="#" class="close">&times;</a><h3 class="webui-popover-title"></h3><div class="webui-popover-content"><i class="icon-refresh"></i> <p>&nbsp;</p></div></div></div>',backdrop:!1,dismissible:!0,onShow:null,onHide:null,abortXHR:!0,autoHide:!1,offsetTop:0,offsetLeft:0,iframeOptions:{frameborder:"0",allowtransparency:"true",id:"",name:"",scrolling:"",onload:"",height:"",width:""}},m=[],t=
g('<div class="webui-popover-backdrop"></div>'),w=0,x=!1,u=g(r),y=function(){for(var a=0;a<m.length;a++)m[a].webuiPopover("hide");u.trigger("hiddenAll.webui.popover")};p.prototype={init:function(){if("click"===this.getTrigger())this.$element.off("click touchend").on("click touchend",g.proxy(this.toggle,this));else if("hover"===this.getTrigger())this.$element.on("mouseenter",g.proxy(this.mouseenterHandler,this)).on("mouseleave",g.proxy(this.mouseleaveHandler,this));this._poped=!1;this._inited=!0;this._opened=
!1;this._idSeed=w;this.options.backdrop&&t.appendTo(r.body).hide();w++;"sticky"===this.getTrigger()&&this.show()},destroy:function(){for(var a=-1,b=0;b<m.length;b++)if(m[b]===this.$element){a=b;break}m.splice(a,1);this.hide();this.$element.data("plugin_"+q,null);"click"===this.getTrigger()?this.$element.off("click"):"hover"===this.getTrigger()&&this.$element.off("mouseenter mouseleave");this.$target&&this.$target.remove()},hide:function(a,b){if((a||"sticky"!==this.getTrigger())&&this._opened){b&&
(b.preventDefault(),b.stopPropagation());this.xhr&&!0===this.options.abortXHR&&(this.xhr.abort(),this.xhr=null);var c=g.Event("hide.webui.popover");this.$element.trigger(c,[this.$target]);if(this.$target){this.$target.removeClass("in").addClass(this.getHideAnimation());var f=this;setTimeout(function(){f.$target.hide()},300)}this.options.backdrop&&t.hide();this._opened=!1;this.$element.trigger("hidden.webui.popover",[this.$target]);if(this.options.onHide)this.options.onHide(this.$target)}},resetAutoHide:function(){var a=
this,b=a.getAutoHide();b&&(a.autoHideHandler&&clearTimeout(a.autoHideHandler),a.autoHideHandler=setTimeout(function(){a.hide()},b))},toggle:function(a){a&&(a.preventDefault(),a.stopPropagation());this[this.getTarget().hasClass("in")?"hide":"show"]()},hideAll:function(){y()},show:function(){if(!(null!=this.options.showCheck&&!1==this.options.showCheck())&&0!=this.$element[0].offsetWidth){var a=this.getTarget().removeClass().addClass("webui-popover").addClass(this._customTargetClass);this.options.multi||
this.hideAll();if(!this._opened){if(!this.getCache()||!this._poped||""===this.content)this.content="",this.setTitle(this.getTitle()),this.options.closeable||a.find(".close").off("click").remove(),this.isAsync()?this.setContentASync(this.options.content):this.setContent(this.getContent()),a.show();this.displayContent();if(this.options.onShow)this.options.onShow(a);this.bindBodyEvents();this.options.backdrop&&t.show();this._opened=!0;this.resetAutoHide()}}},displayContent:function(){var a=this.getElementPosition(),
b=this.getTarget().removeClass().addClass("webui-popover").addClass(this._customTargetClass),c=this.getContentElement(),f=b[0].offsetWidth,d=b[0].offsetHeight,e="bottom",e=g.Event("show.webui.popover");this.$element.trigger(e,[b]);e=this.$element.data("width")||this.options.width;""===e&&(e=this._defaults.width);"auto"!==e&&b.width(e);e=this.$element.data("height")||this.options.height;""===e&&(e=this._defaults.height);"auto"!==e&&c.height(e);this.options.style&&this.$target.addClass("webui-popover-"+
this.options.style);this.options.arrow||b.find(".arrow").remove();b.detach().css({top:-2E3,left:-2E3,display:"block"});this.getAnimation()&&b.addClass(this.getAnimation());b.appendTo(r.body);e=this.getPlacement(a);this.$element.trigger("added.webui.popover");this.initTargetEvents();this.options.padding||("auto"!==this.options.height&&c.css("height",c.outerHeight()),this.$target.addClass("webui-no-padding"));f=b[0].offsetWidth;d=b[0].offsetHeight;a=this.getTargetPositin(a,e,f,d);this.$target.css(a.position).addClass(e).addClass("in");
"iframe"===this.options.type&&(c=b.find("iframe"),b=b.width(),f=c.parent().height(),""!==this.options.iframeOptions.width&&"auto"!==this.options.iframeOptions.width&&(b=this.options.iframeOptions.width),""!==this.options.iframeOptions.height&&"auto"!==this.options.iframeOptions.height&&(f=this.options.iframeOptions.height),c.width(b).height(f));this.options.arrow||this.$target.css({margin:0});this.options.arrow&&(b=this.$target.find(".arrow"),b.removeAttr("style"),"left"===e||"right"===e?b.css({top:this.$target.height()/
2}):("top"===e||"bottom"===e)&&b.css({left:this.$target.width()/2}),a.arrowOffset&&(-1===a.arrowOffset.left||-1===a.arrowOffset.top?b.hide():b.css(a.arrowOffset)));this._poped=!0;this.$element.trigger("shown.webui.popover",[this.$target])},isTargetLoaded:function(){return 0===this.getTarget().find("i.glyphicon-refresh").length},getTriggerElement:function(){return this.$element},getTarget:function(){if(!this.$target){var a=q+this._idSeed;this.$target=g(this.options.template).attr("id",a).data("trigger-element",
this.getTriggerElement());this._customTargetClass="webui-popover"!==this.$target.attr("class")?this.$target.attr("class"):null;this.getTriggerElement().attr("data-target",a)}return this.$target},getTitleElement:function(){return this.getTarget().find(".webui-popover-title")},getContentElement:function(){this.$contentElement||(this.$contentElement=this.getTarget().find(".webui-popover-content"));return this.$contentElement},getTitle:function(){return this.$element.attr("data-title")||this.options.title||
this.$element.attr("title")},getUrl:function(){return this.$element.attr("data-url")||this.options.url},getAutoHide:function(){return this.$element.attr("data-auto-hide")||this.options.autoHide},getOffsetTop:function(){var a=this.$element.attr("data-offset-top");return(isNaN(a)?0:Number(a))||this.options.offsetTop},getOffsetLeft:function(){var a=this.$element.attr("data-offset-left");return(isNaN(a)?0:Number(a))||this.options.offsetLeft},getCache:function(){var a=this.$element.attr("data-cache");
if("undefined"!==typeof a)switch(a.toLowerCase()){case "true":case "yes":case "1":return!0;case "false":case "no":case "0":return!1}return this.options.cache},getTrigger:function(){return this.$element.attr("data-trigger")||this.options.trigger},getDelayShow:function(){var a=this.$element.attr("data-delay-show");return"undefined"!==typeof a?a:0===this.options.delay.show?0:this.options.delay.show||100},getHideDelay:function(){var a=this.$element.attr("data-delay-hide");return"undefined"!==typeof a?
a:0===this.options.delay.hide?0:this.options.delay.hide||100},getAnimation:function(){return this.$element.attr("data-animation")||this.options.animation},getHideAnimation:function(){var a=this.getAnimation();return a?a+"-out":"out"},setTitle:function(a){var b=this.getTitleElement();a?b.html(a):b.remove()},hasContent:function(){return this.getContent()},getIframe:function(){var a=g("<iframe></iframe>").attr("src",this.getUrl()),b=this;g.each(this._defaults.iframeOptions,function(c){"undefined"!==
typeof b.options.iframeOptions[c]&&a.attr(c,b.options.iframeOptions[c])});return a},getContent:function(){if(this.getUrl())switch(this.options.type){case "iframe":this.content=this.getIframe();break;case "html":try{this.content=g(this.getUrl()),this.content.is(":visible")||this.content.show()}catch(a){throw Error("Unable to get popover content. Invalid selector specified.");}}else if(!this.content){var b="",b=g.isFunction(this.options.content)?this.options.content.apply(this.$element[0],[this]):this.options.content;
this.content=this.$element.attr("data-content")||b;if(!this.content&&(b=this.$element.next())&&b.hasClass("webui-popover-content"))this.content=b}return this.content},setContent:function(a){var b=this.getTarget(),c=this.getContentElement();"string"===typeof a?c.html(a):a instanceof jQuery&&(a.removeClass("webui-popover-content"),c.html(""),a.appendTo(c));this.$target=b},isAsync:function(){return"async"===this.options.type},setContentASync:function(a){var b=this;this.xhr||(this.xhr=g.ajax({url:this.getUrl(),
type:"GET",cache:this.getCache(),beforeSend:function(a){b.options.async.before&&b.options.async.before(b,a)},success:function(c){b.bindBodyEvents();a&&g.isFunction(a)?b.content=a.apply(b.$element[0],[c]):b.content=c;b.setContent(b.content);b.getContentElement().removeAttr("style");b.displayContent();b.options.async.success&&b.options.async.success(b,c)},complete:function(){b.xhr=null}}))},bindBodyEvents:function(){this.options.dismissible&&("click"===this.getTrigger()&&!x)&&(u.off("keyup.webui-popover").on("keyup.webui-popover",
g.proxy(this.escapeHandler,this)),u.off("click.webui-popover touchend.webui-popover").on("click.webui-popover touchend.webui-popover",g.proxy(this.bodyClickHandler,this)))},mouseenterHandler:function(){var a=this;a._timeout&&clearTimeout(a._timeout);a._enterTimeout=setTimeout(function(){a.getTarget().is(":visible")||a.show()},this.getDelayShow())},mouseleaveHandler:function(){var a=this;clearTimeout(a._enterTimeout);a._timeout=setTimeout(function(){a.hide()},this.getHideDelay())},escapeHandler:function(a){27===
a.keyCode&&this.hideAll()},bodyClickHandler:function(a){for(var b=x=!0,c=0;c<m.length;c++){var f=m[c].data("plugin_"+q);if(f._opened){var d=f.getTarget().offset().left,e=f.getTarget().offset().top,g=f.getTarget().offset().left+f.getTarget().width(),f=f.getTarget().offset().top+f.getTarget().height(),k,h=a;k={x:0,y:0};if("touchstart"===h.type||"touchmove"===h.type||"touchend"===h.type||"touchcancel"===h.type)h=h.originalEvent.touches[0]||h.originalEvent.changedTouches[0],k.x=h.pageX,k.y=h.pageY;else if("mousedown"===
h.type||"mouseup"===h.type||"click"===h.type)k.x=h.pageX,k.y=h.pageY;if(k.x>=d&&k.x<=g&&k.y>=e&&k.y<=f){b=!1;break}}}b&&y()},initTargetEvents:function(){if("hover"===this.getTrigger())this.$target.off("mouseenter mouseleave").on("mouseenter",g.proxy(this.mouseenterHandler,this)).on("mouseleave",g.proxy(this.mouseleaveHandler,this));this.$target.find(".close").off("click").on("click",g.proxy(this.hide,this,!0))},getPlacement:function(a){var b=r.documentElement,c=r.body,f=b.clientWidth,d=b.clientHeight,
e=Math.max(c.scrollTop,b.scrollTop),b=Math.max(c.scrollLeft,b.scrollLeft),b=Math.max(0,a.left-b),e=Math.max(0,a.top-e);a="function"===typeof this.options.placement?this.options.placement.call(this,this.getTarget()[0],this.$element[0]):this.$element.data("placement")||this.options.placement;var c="horizontal"===a,g="vertical"===a;"auto"===a||c||g?a=b<f/3?e<d/3?c?"right-bottom":"bottom-right":e<2*d/3?g?e<=d/2?"bottom-right":"top-right":"right":c?"right-top":"top-right":b<2*f/3?e<d/3?c?b<=f/2?"right-bottom":
"left-bottom":"bottom":e<2*d/3?c?b<=f/2?"right":"left":e<=d/2?"bottom":"top":c?b<=f/2?"right-top":"left-top":"top":e<d/3?c?"left-bottom":"bottom-left":e<2*d/3?g?e<=d/2?"bottom-left":"top-left":"left":c?"left-top":"top-left":"auto-top"===a?a=b<f/3?"top-right":b<2*f/3?"top":"top-left":"auto-bottom"===a?a=b<f/3?"bottom-right":b<2*f/3?"bottom":"bottom-left":"auto-left"===a?a=e<d/3?"left-top":e<2*d/3?"left":"left-bottom":"auto-right"===a&&(a=e<d/3?"right-top":e<2*d/3?"right":"right-bottom");return a},
getElementPosition:function(){return g.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTargetPositin:function(a,b,c,f){var d=r.documentElement,e=r.body,g=d.clientWidth,k=d.clientHeight,h=this.$element.outerWidth(),m=this.$element.outerHeight(),q=Math.max(e.scrollTop,d.scrollTop),s=Math.max(e.scrollLeft,d.scrollLeft),d={},e=null,l=this.options.arrow?20:0,n=h<l+10?l:0,l=m<l+10?l:0,p=0<a.left+a.width/2-n,g=a.left+a.width/2+n<g+s,s=0<a.top+
a.height/2-l,k=a.top+a.height/2+l<k+q;switch(b){case "bottom":d={top:a.top+a.height,left:a.left+a.width/2-c/2};break;case "top":d={top:a.top-f,left:a.left+a.width/2-c/2};break;case "left":d={top:a.top+a.height/2-f/2,left:a.left-c};break;case "right":d={top:a.top+a.height/2-f/2,left:a.left+a.width};break;case "top-right":d={top:a.top-f,left:p?a.left-n:10};e={left:p?Math.min(h,c)/2+n:-2E3};break;case "top-left":d={top:a.top-f,left:a.left-c+a.width+(g?n:-10)};e={left:g?c-Math.min(h,c)/2-n:-2E3};break;
case "bottom-right":d={top:a.top+a.height,left:p?a.left-n:10};e={left:p?Math.min(h,c)/2+n:-2E3};break;case "bottom-left":d={top:a.top+a.height,left:a.left-c+a.width+(g?n:-10)};e={left:g?c-Math.min(h,c)/2-n:-2E3};break;case "right-top":d={top:a.top-f+a.height+(k?l:-10),left:a.left+a.width};e={top:k?f-Math.min(m,f)/2-l:-2E3};break;case "right-bottom":d={top:s?a.top-l:10,left:a.left+a.width};e={top:s?Math.min(m,f)/2+l:-2E3};break;case "left-top":d={top:a.top-f+a.height+(k?l:-10),left:a.left-c};e={top:k?
f-Math.min(m,f)/2-l:-2E3};break;case "left-bottom":d={top:s?a.top-l:10,left:a.left-c},e={top:s?Math.min(m,f)/2+l:-2E3}}d.top+=this.getOffsetTop();d.left+=this.getOffsetLeft();return{position:d,arrowOffset:e}}};g.fn[q]=function(a,b){var c=[],f=this.each(function(){var d=g.data(this,"plugin_"+q);d?"destroy"===a?d.destroy():"string"===typeof a&&c.push(d[a]()):(a?"string"===typeof a?"destroy"!==a&&!b&&(d=new p(this,null),c.push(d[a]())):"object"===typeof a&&(d=new p(this,a)):d=new p(this,null),g.data(this,
"plugin_"+q,d))});return c.length?c:f}})(jQuery,window,document);
